<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="boardMapper">
	<resultMap type="com.example.demo.board.BoardVo" id="BoardResultSet">
	    <result property="boardNo" column="board_no"/>
	    <result property="boardTitle" column="board_title"/>
	    <result property="boardContent" column="board_content"/>
	    <result property="boardWriter" column="board_writer"/>
	    <result property="boardStatus" column="board_status"/>
	    <result property="regDate" column="reg_date"/>
	    <result property="modDate" column="mod_date"/>
	</resultMap>

	<!-- 게시판 총 개수 -->
	<select id="selectListCount" parameterType="String" resultType="int">
		SELECT COUNT(*)
		FROM board b
    	WHERE b.board_status = 'Y'
   		<if test="keyword != null and keyword != ''">
	         AND b.board_title LIKE CONCAT('%', #{keyword}, '%')
        </if>
	</select>
	
	<!-- 게시판 리스트 가져오기 -->
    <select id="selectAll" parameterType="map" resultMap="BoardResultSet">
        SELECT b.board_no, b.board_title, b.board_content, b.board_date, a.user_id as board_writer,
        FROM board b 
			LEFT JOIN auth a ON b.board_writer = a.user_no 
        WHERE b.board_status = 'Y'
	   	<if test="keyword != null and keyword != ''">
 			AND b.board_title LIKE CONCAT('%', #{keyword}, '%')
        </if>
        ORDER BY b.board_no DESC
        LIMIT #{boardLimit} OFFSET #{startRow}
    </select>
	
	<!-- 게시판 상세 가져오기 -->
	<select id="selectByIndex" parameterType="int" resultMap="BoardResultSet">
		SELECT b.board_no, b.board_title, b.board_content, b.board_date, 
		       b.board_status, a.user_id as board_writer
		FROM board b
		LEFT JOIN auth a ON b.board_writer = a.user_no 
		WHERE b.board_no = #{bno};
	</select>
	
	<!-- 게시판 작성 -->
	<insert id="insertBoard" parameterType="com.example.demo.board.BoardVo">
		INSERT INTO board (board_title, board_content, board_writer)
		VALUE (#{boardTitle}, #{boardContent}, #{boardWriter});
	</insert>
	
	<!-- 게시판 업데이트 -->
	<update id="updateBoardByIndex" parameterType="com.example.demo.board.BoardVo">
		UPDATE board
		SET board_title=#{boardTitle}, board_content=#{boardContent}
		WHERE board_no=#{boardNo}
	</update>
	
	<!-- 게시판 삭제 -->
	<delete id="deleteBoardByIndex" parameterType="int">
		DELETE FROM board
		WHERE board_no=#{bno}
	</delete>
</mapper>